{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport _regeneratorRuntime from \"C:/off-saas/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"C:/off-saas/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { withSuperJSONPage as _withSuperJSONPage } from \"babel-plugin-superjson-next/tools\";\n\nvar _jsxFileName = \"C:\\\\off-saas\\\\pages\\\\dashboard\\\\account.js\",\n    _this = this,\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from 'react';\nimport { useAuth } from '../../lib/newAuth';\nimport { db } from '../../lib/firebase';\nimport NavbarTemplate from '../../components/dashboard/NavbarTemplate';\nimport { createCheckoutSessionThreeDays, createCheckoutSessionWeekly, goToBillingPortal } from '../../lib/db';\nimport TippyMonster from '../../components/dashboard/Tippy';\nimport ActivePlan from '../../components/dashboard/account/ActivePlan';\n\nvar AccountPage = function AccountPage() {\n  _s();\n\n  var _useAuth = useAuth(),\n      currentUser = _useAuth.currentUser,\n      logOut = _useAuth.logOut;\n\n  var _useState = useState(null),\n      activePlan = _useState[0],\n      setActivePlan = _useState[1];\n\n  var _useState2 = useState(''),\n      planRole = _useState2[0],\n      setPlanRole = _useState2[1];\n\n  var _useState3 = useState(''),\n      activePlanPeriodEnd = _useState3[0],\n      setActivePlanPeriodEnd = _useState3[1];\n\n  console.log(currentUser);\n  useEffect(function () {\n    // Fetch users current plan\n    if (currentUser.stripeRole === 'free') {\n      setActivePlan('free');\n    } else {\n      db.collection('users').doc(currentUser.uid).collection('subscriptions').where('status', 'in', ['trialing', 'active']).onSnapshot( /*#__PURE__*/function () {\n        var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(snapshot) {\n          var doc, data;\n          return _regeneratorRuntime.wrap(function _callee$(_context) {\n            while (1) {\n              switch (_context.prev = _context.next) {\n                case 0:\n                  // In this implementation we only expect one active or trialing subscription to exist.\n                  doc = snapshot.docs[0];\n                  data = doc.data();\n                  console.log(doc.data());\n                  setPlanRole(data.role);\n                  setActivePlanPeriodEnd(new Date(data.current_period_end.seconds * 1000));\n\n                case 5:\n                case \"end\":\n                  return _context.stop();\n              }\n            }\n          }, _callee);\n        }));\n\n        return function (_x) {\n          return _ref.apply(this, arguments);\n        };\n      }());\n    }\n  }, []);\n  console.log(activePlan && activePlan);\n  console.log(activePlanPeriodEnd && activePlanPeriodEnd);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(TippyMonster, {\n      startups: true,\n      contentClass: \"h-40 w-80 shadow-lg rounded-2xl bg-primary flex justify-center items-center\",\n      contentText: \"This is a place where magical things happen \",\n      contentText1: \" Just start creating your startup and bring your idea into reality. Once you've done that, you can manage it from the main panel. Feel free to edit, save or delete your idea\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 40,\n      columnNumber: 7\n    }, _this), /*#__PURE__*/_jsxDEV(NavbarTemplate, {\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"min-h-screen w-full relative flex flex-col items-center text-primarydark\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"w-full sm:max-w-smContainer md:max-w-mdContainer lg:max-w-lgContainer xl:max-w-xlContainer 2xl:max-w-xxlContainer normal:max-w-normalContainer relative mt-12\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"grid grid-cols-2 grid-rows-1 grid-flow-col\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center\",\n              children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n                height: \"30\",\n                width: \"30\",\n                className: \"fill-current text-primary dark:text-primarydark\",\n                xmlns: \"http://www.w3.org/2000/svg\",\n                viewBox: \"0 0 128 128\",\n                children: [/*#__PURE__*/_jsxDEV(\"title\", {\n                  children: \"Landing Success\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 58,\n                  columnNumber: 19\n                }, _this), /*#__PURE__*/_jsxDEV(\"g\", {\n                  id: \"Landing_Success\",\n                  \"data-name\": \"Landing Success\",\n                  children: /*#__PURE__*/_jsxDEV(\"path\", {\n                    className: \"cls-1\",\n                    d: \"M109.3,90.1A46,46,0,0,0,65,36V20.08c1.78-.62,7.21-2.14,12.57.23a19.33,19.33,0,0,0,14.82,0c.87-.38.61.31.61-17.93a1,1,0,0,0-1.43-.93c-.07,0-6.69,2.87-13.18,0A19.41,19.41,0,0,0,65,.93,1,1,0,0,0,63,1V36a45.86,45.86,0,0,0-28.66,10.8C16.18,40.48,4,40,.79,45.51-2.29,50.86,3.94,59.3,10,65.68A11,11,0,0,0,18,83c.81,38.41,46.08,59.2,75.66,34.21,8.53,3,29,9.15,33.55,1.31C130.39,113,123.86,102.65,109.3,90.1ZM77.59,3.31A19.39,19.39,0,0,0,91,3.83V18.68c-1.79.62-7.22,2.13-12.57-.23A19.19,19.19,0,0,0,65,17.93V3.08C66.81,2.46,72.24,1,77.59,3.31ZM65,45v-7c39.69.91,58,50.27,28.21,76.81C71.32,107,46,92.66,27.77,78.64a11,11,0,0,0-3.2-16.13A43.88,43.88,0,0,1,63,38.06V45A1,1,0,0,0,65,45ZM32.55,48.36a46.21,46.21,0,0,0-9.83,13.28,10.93,10.93,0,0,0-11.4,2.47C-8.39,43.23,5.23,39.08,32.55,48.36ZM10,72a9,9,0,1,1,9,9A9,9,0,0,1,10,72Zm10,11a11,11,0,0,0,6.34-2.82c18.45,14.21,43.45,28.35,65.05,36.22C63,139.16,20.83,119.1,20.05,83Zm105.4,34.5c-2.51,4.35-14,3.62-30-1.85a45.61,45.61,0,0,0,13.42-23.21C121.59,103.58,128,113.12,125.45,117.47Z\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 60,\n                    columnNumber: 21\n                  }, _this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 59,\n                  columnNumber: 19\n                }, _this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 51,\n                columnNumber: 17\n              }, _this), /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"self-end text-2xl pl-2 dark:text-background relative top-1.5\",\n                children: \"Account\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 66,\n                columnNumber: 17\n              }, _this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 50,\n              columnNumber: 15\n            }, _this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 49,\n            columnNumber: 13\n          }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text text-gray mt-0.5\",\n              children: \"Manage your account details, your current plan and invoices\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 70,\n              columnNumber: 15\n            }, _this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 69,\n            columnNumber: 13\n          }, _this), /*#__PURE__*/_jsxDEV(ActivePlan, {\n            planRole: planRole,\n            activePlan: activePlan,\n            activePlanPeriodEnd: activePlanPeriodEnd\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 73,\n            columnNumber: 13\n          }, _this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 48,\n          columnNumber: 11\n        }, _this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 47,\n        columnNumber: 9\n      }, _this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: logOut,\n        children: \"Log Out\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 77,\n        columnNumber: 9\n      }, _this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 46,\n      columnNumber: 7\n    }, _this)]\n  }, void 0, true);\n};\n\n_s(AccountPage, \"61UCk2EumLl5DoXprkWL0V7TuD8=\", false, function () {\n  return [useAuth];\n});\n\n_c = AccountPage;\nexport default _c2 = _withSuperJSONPage(AccountPage);\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"AccountPage\");\n$RefreshReg$(_c2, \"%default%\");","map":{"version":3,"sources":["C:/off-saas/pages/dashboard/account.js"],"names":["React","useEffect","useState","useAuth","db","NavbarTemplate","createCheckoutSessionThreeDays","createCheckoutSessionWeekly","goToBillingPortal","TippyMonster","ActivePlan","AccountPage","currentUser","logOut","activePlan","setActivePlan","planRole","setPlanRole","activePlanPeriodEnd","setActivePlanPeriodEnd","console","log","stripeRole","collection","doc","uid","where","onSnapshot","snapshot","docs","data","role","Date","current_period_end","seconds"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { useAuth } from '../../lib/newAuth';\r\nimport { db } from '../../lib/firebase';\r\nimport NavbarTemplate from '../../components/dashboard/NavbarTemplate';\r\nimport { createCheckoutSessionThreeDays, createCheckoutSessionWeekly, goToBillingPortal } from '../../lib/db';\r\nimport TippyMonster from '../../components/dashboard/Tippy';\r\nimport ActivePlan from '../../components/dashboard/account/ActivePlan';\r\n\r\nconst AccountPage = () => {\r\n  const { currentUser, logOut } = useAuth();\r\n  const [activePlan, setActivePlan] = useState(null);\r\n  const [planRole, setPlanRole] = useState('');\r\n  const [activePlanPeriodEnd, setActivePlanPeriodEnd] = useState('');\r\n\r\n  console.log(currentUser);\r\n  useEffect(() => {\r\n    // Fetch users current plan\r\n    if (currentUser.stripeRole === 'free') {\r\n      setActivePlan('free');\r\n    } else {\r\n      db.collection('users')\r\n        .doc(currentUser.uid)\r\n        .collection('subscriptions')\r\n        .where('status', 'in', ['trialing', 'active'])\r\n        .onSnapshot(async (snapshot) => {\r\n          // In this implementation we only expect one active or trialing subscription to exist.\r\n          const doc = snapshot.docs[0];\r\n          const data = doc.data();\r\n          console.log(doc.data());\r\n          setPlanRole(data.role);\r\n          setActivePlanPeriodEnd(new Date(data.current_period_end.seconds * 1000));\r\n        });\r\n    }\r\n  }, []);\r\n  console.log(activePlan && activePlan);\r\n  console.log(activePlanPeriodEnd && activePlanPeriodEnd);\r\n\r\n  return (\r\n    <>\r\n      <TippyMonster\r\n        startups\r\n        contentClass=\"h-40 w-80 shadow-lg rounded-2xl bg-primary flex justify-center items-center\"\r\n        contentText=\"This is a place where magical things happen \"\r\n        contentText1=\" Just start creating your startup and bring your idea into reality. Once you've done that, you can manage it from the main panel. Feel free to edit, save or delete your idea\"\r\n      />\r\n      <NavbarTemplate>\r\n        <div className=\"min-h-screen w-full relative flex flex-col items-center text-primarydark\">\r\n          <div className=\"w-full sm:max-w-smContainer md:max-w-mdContainer lg:max-w-lgContainer xl:max-w-xlContainer 2xl:max-w-xxlContainer normal:max-w-normalContainer relative mt-12\">\r\n            <div className=\"grid grid-cols-2 grid-rows-1 grid-flow-col\">\r\n              <div className=\"flex items-center\">\r\n                <svg\r\n                  height=\"30\"\r\n                  width=\"30\"\r\n                  className=\"fill-current text-primary dark:text-primarydark\"\r\n                  xmlns=\"http://www.w3.org/2000/svg\"\r\n                  viewBox=\"0 0 128 128\"\r\n                >\r\n                  <title>Landing Success</title>\r\n                  <g id=\"Landing_Success\" data-name=\"Landing Success\">\r\n                    <path\r\n                      className=\"cls-1\"\r\n                      d=\"M109.3,90.1A46,46,0,0,0,65,36V20.08c1.78-.62,7.21-2.14,12.57.23a19.33,19.33,0,0,0,14.82,0c.87-.38.61.31.61-17.93a1,1,0,0,0-1.43-.93c-.07,0-6.69,2.87-13.18,0A19.41,19.41,0,0,0,65,.93,1,1,0,0,0,63,1V36a45.86,45.86,0,0,0-28.66,10.8C16.18,40.48,4,40,.79,45.51-2.29,50.86,3.94,59.3,10,65.68A11,11,0,0,0,18,83c.81,38.41,46.08,59.2,75.66,34.21,8.53,3,29,9.15,33.55,1.31C130.39,113,123.86,102.65,109.3,90.1ZM77.59,3.31A19.39,19.39,0,0,0,91,3.83V18.68c-1.79.62-7.22,2.13-12.57-.23A19.19,19.19,0,0,0,65,17.93V3.08C66.81,2.46,72.24,1,77.59,3.31ZM65,45v-7c39.69.91,58,50.27,28.21,76.81C71.32,107,46,92.66,27.77,78.64a11,11,0,0,0-3.2-16.13A43.88,43.88,0,0,1,63,38.06V45A1,1,0,0,0,65,45ZM32.55,48.36a46.21,46.21,0,0,0-9.83,13.28,10.93,10.93,0,0,0-11.4,2.47C-8.39,43.23,5.23,39.08,32.55,48.36ZM10,72a9,9,0,1,1,9,9A9,9,0,0,1,10,72Zm10,11a11,11,0,0,0,6.34-2.82c18.45,14.21,43.45,28.35,65.05,36.22C63,139.16,20.83,119.1,20.05,83Zm105.4,34.5c-2.51,4.35-14,3.62-30-1.85a45.61,45.61,0,0,0,13.42-23.21C121.59,103.58,128,113.12,125.45,117.47Z\"\r\n                    />\r\n                  </g>\r\n                </svg>\r\n                <p className=\"self-end text-2xl pl-2 dark:text-background relative top-1.5\">Account</p>\r\n              </div>\r\n            </div>\r\n            <div>\r\n              <p className=\"text text-gray mt-0.5\">Manage your account details, your current plan and invoices</p>\r\n            </div>\r\n            {/* Plan details */}\r\n            <ActivePlan planRole={planRole} activePlan={activePlan} activePlanPeriodEnd={activePlanPeriodEnd} />\r\n          </div>\r\n        </div>\r\n        {/* <p>Current plan: {currentUser.stripeRole}</p> */}\r\n        <button onClick={logOut}>Log Out</button>\r\n      </NavbarTemplate>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default AccountPage;\r\n"]},"metadata":{},"sourceType":"module"}