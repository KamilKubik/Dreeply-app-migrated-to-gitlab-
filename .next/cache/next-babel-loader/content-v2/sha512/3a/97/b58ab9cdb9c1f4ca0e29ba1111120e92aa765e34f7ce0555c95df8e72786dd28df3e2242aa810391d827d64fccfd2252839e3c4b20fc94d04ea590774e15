{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { withSuperJSONPage as _withSuperJSONPage } from \"babel-plugin-superjson-next/tools\";\nimport React, { useEffect, useState, useRef } from 'react';\nimport { useRouter } from 'next/router';\nimport gsap, { Linear } from 'gsap';\nimport { v4 as uuidv4 } from 'uuid';\nimport { useAuth } from '../../../../lib/newAuth';\nimport { db } from '../../../../lib/firebase';\nimport NavbarTemplate from '../../../../components/dashboard/NavbarTemplate';\nimport { CountryDropdown } from 'react-country-region-selector';\nimport ImagesModal from '../../../../components/dashboard/startup/ImagesModal';\nimport Image from 'next/image';\nimport TippyMonster from '../../../../components/dashboard/Tippy';\nimport BounceLoaderComponent from '../../../../components/BounceLoader';\n\nconst StartupEdit = () => {\n  const {\n    0: projects,\n    1: setProjects\n  } = useState(null);\n  const {\n    0: currentProject,\n    1: setCurrentProject\n  } = useState(null);\n  const {\n    0: existingProjectName,\n    1: setExistingProjectName\n  } = useState('');\n  const {\n    0: projectName,\n    1: setProjectName\n  } = useState('');\n  const {\n    0: projectDescription,\n    1: setProjectDescription\n  } = useState('');\n  const {\n    0: projectField,\n    1: setProjectField\n  } = useState('');\n  const {\n    0: projectCountry,\n    1: setProjectCountry\n  } = useState('');\n  const {\n    0: projectEmail,\n    1: setProjectEmail\n  } = useState('');\n  const {\n    0: projectNumber,\n    1: setProjectNumber\n  } = useState('');\n  const {\n    0: projectImage,\n    1: setProjectImage\n  } = useState('');\n  const {\n    0: imageName,\n    1: setImageName\n  } = useState('blank');\n  const {\n    0: projectId,\n    1: setProjectId\n  } = useState('');\n  const {\n    0: imagesModal,\n    1: setImagesModal\n  } = useState(false);\n  const {\n    0: fileUrl,\n    1: setFileUrl\n  } = useState(null); // LOADING SCREEN\n\n  const {\n    0: loadingScreen,\n    1: setLoadingScreen\n  } = useState(false); // GSAP\n\n  const mainContainer = useRef();\n  const router = useRouter();\n  const {\n    currentUser\n  } = useAuth();\n  useEffect(async () => {\n    // FETCH CURRENT PROJECT\n    const currentProject = [];\n    await db.collection('projects').where('uid', '==', currentUser.uid).where('projectName', '==', router.query.project).get().then(querySnapshot => {\n      if (querySnapshot.empty) {\n        return router.push('/dashboard/startup');\n      }\n\n      querySnapshot.forEach(doc => {\n        setProjectName(doc.data().projectName);\n        setProjectDescription(doc.data().projectDescription);\n        setProjectField(doc.data().projectField);\n        setProjectCountry(doc.data().projectCountry);\n        setProjectEmail(doc.data().projectEmail);\n        setProjectNumber(doc.data().projectNumber);\n        setImageName(doc.data().imageName);\n        setFileUrl(doc.data().imageFileUrl);\n        setProjectId(doc.data().projectId);\n        setExistingProjectName(doc.data().projectName);\n        currentProject.push(doc.data());\n      });\n    });\n    setCurrentProject(currentProject); // FETCH ALL USER PROJECTS\n\n    const projects = [];\n    await db.collection('projects').where('uid', '==', currentUser.uid).get().then(querySnapshot => {\n      if (querySnapshot.empty) {\n        return router.push('/dashboard/startup');\n      }\n\n      querySnapshot.forEach(doc => {\n        projects.push(doc.data());\n      });\n    });\n    setProjects(projects);\n  }, []);\n  console.log(currentProject);\n  console.log(projects);\n  console.log(projectName);\n  console.log(router.query.project);\n\n  const onProjectEdit = async e => {\n    e.preventDefault();\n    projects && projects.map(project => {\n      if (project.projectName == projectName && projectName !== router.query.project) {\n        setWrongNameTippyHelper(true);\n        return;\n      }\n    });\n\n    if (!projectName || !projectDescription || !projectField || !projectCountry || !projectEmail || !projectNumber || !imageName && !fileUrl) {\n      setTippyHelper(true);\n      return;\n    } // HIDE CURRENT CONTAINER\n\n\n    await gsap.to(mainContainer.current, {\n      autoAlpha: 0,\n      duration: 1,\n      ease: Linear\n    }); // SHOW LOADING SCREEN\n\n    setLoadingScreen(true); // UPDATED PROJECT\n\n    const newProject = {\n      projectName: projectName,\n      projectDescription: projectDescription,\n      projectField: projectField,\n      projectCountry: projectCountry,\n      projectEmail: projectEmail,\n      projectNumber: projectNumber,\n      imageName,\n      imageFileUrl: fileUrl\n    };\n    await db.collection('projects').doc(projectId).update(newProject);\n    router.push(`/dashboard/projects/${projectName}`);\n  };\n\n  const onFileChange = async e => {\n    if (imageName && fileUrl) {\n      setImageName('blank');\n    }\n\n    setImagesModal(false);\n    const file = e.target.files[0];\n    const storageRef = storage.ref();\n    const fileRef = storageRef.child(file.name);\n    await fileRef.put(file);\n    setFileUrl(await fileRef.getDownloadURL());\n  };\n\n  const browseImageOpen = () => {\n    setImagesModal(true);\n    setImageName('blank');\n  };\n\n  const {\n    0: tippyHelper,\n    1: setTippyHelper\n  } = useState(false);\n  const {\n    0: wrongNameTippyHelper,\n    1: setWrongNameTippyHelper\n  } = useState(false);\n  return /*#__PURE__*/_jsxs(_Fragment, {\n    children: [/*#__PURE__*/_jsx(TippyMonster, {\n      tippyMonster: tippyHelper ? true : false,\n      wrongName: wrongNameTippyHelper ? true : false,\n      setTippyHelper: setTippyHelper,\n      setWrongNameTippyHelper: setWrongNameTippyHelper,\n      projectCreator: true,\n      contentClass: \"h-20 w-80 shadow-lg rounded-2xl bg-primary flex justify-center items-center\",\n      contentText: \"Let's modify the fundamental information about your startup.\"\n    }), imagesModal && /*#__PURE__*/_jsx(ImagesModal, {\n      currentUser: currentUser,\n      onFileChange: onFileChange,\n      setImagesModal: setImagesModal,\n      setImageName: setImageName\n    }), loadingScreen ? /*#__PURE__*/_jsx(BounceLoaderComponent, {}) : /*#__PURE__*/_jsx(NavbarTemplate, {\n      children: /*#__PURE__*/_jsx(\"div\", {\n        ref: mainContainer,\n        className: \"min-h-screen w-full max-w-full relative px-32 py-16 flex items-center flex-col\",\n        children: /*#__PURE__*/_jsxs(\"div\", {\n          className: \"z-10 p-10 h-auto grid grid-cols-1 grid-rows-3 w-auto max-w-nameContainer w-full bg-white rounded-3xl\",\n          children: [/*#__PURE__*/_jsxs(\"div\", {\n            className: \"row-span-1 text-center\",\n            children: [/*#__PURE__*/_jsxs(\"div\", {\n              className: \"text-2xl font-medium flex items-center justify-center\",\n              children: [/*#__PURE__*/_jsx(\"img\", {\n                src: \"/project-create/rocket.svg\",\n                height: 36,\n                width: 36,\n                className: \"inline-block relative bottom-1\"\n              }), /*#__PURE__*/_jsx(\"p\", {\n                className: \"ml-2 text-primarydark\",\n                children: \"Let's create your startup!\"\n              })]\n            }), /*#__PURE__*/_jsx(\"div\", {\n              className: \"text-base text-gray px-4\",\n              children: \"Oops, one more tiny step and we will get down to business.\"\n            })]\n          }), /*#__PURE__*/_jsx(\"div\", {\n            className: \"row-span-2\",\n            children: /*#__PURE__*/_jsxs(\"form\", {\n              onSubmit: e => onProjectEdit(e),\n              className: \"z-50 px-4 pt-2 rounded-2xl mt-4\",\n              children: [/*#__PURE__*/_jsx(\"div\", {\n                className: \"mb-4\",\n                children: /*#__PURE__*/_jsx(\"input\", {\n                  value: projectName,\n                  onChange: e => setProjectName(e.target.value),\n                  id: \"startup-name\",\n                  className: \"border border-background focus:border-primary shadow appearance-none rounded w-full py-3 px-4 text-primarydark leading-tight focus:outline-none focus:shadow-outline text-sm bg-white rounded-2xl mr-2\",\n                  type: \"startup-name\",\n                  placeholder: \"startup name\"\n                })\n              }), /*#__PURE__*/_jsx(\"div\", {\n                className: \"mb-4\",\n                children: /*#__PURE__*/_jsx(\"textarea\", {\n                  value: projectDescription,\n                  onChange: e => setProjectDescription(e.target.value),\n                  id: \"startup-description\",\n                  style: {\n                    maxHeight: 160\n                  },\n                  className: \"border border-background focus:border-primary shadow appearance-none rounded w-full py-3 px-4 text-primarydark leading-tight focus:outline-none focus:shadow-outline text-sm bg-white rounded-2xl mr-2 pb-12\",\n                  type: \"startup-description\",\n                  placeholder: \"startup description\"\n                })\n              }), /*#__PURE__*/_jsxs(\"div\", {\n                className: \"mb-4\",\n                children: [/*#__PURE__*/_jsxs(\"div\", {\n                  className: \"flex justify-items-stretch\",\n                  children: [/*#__PURE__*/_jsx(\"input\", {\n                    value: projectField,\n                    onChange: e => setProjectField(e.target.value),\n                    autoComplete: \"none\",\n                    className: \"border border-background focus:border-primary shadow appearance-none rounded w-full py-3 px-4 text-primarydark leading-tight focus:outline-none focus:shadow-outline text-sm bg-white rounded-2xl mr-2\",\n                    type: \"text\",\n                    placeholder: \"Startup field\"\n                  }), /*#__PURE__*/_jsx(CountryDropdown, {\n                    value: projectCountry,\n                    onChange: country => setProjectCountry(country),\n                    id: \"test\",\n                    defaultOptionLabel: \"Country\",\n                    className: `${projectCountry ? 'text-primarydark' : 'text-placeholder'} border border-background focus:border-primary shadow appearance-none rounded w-full py-3 px-4 leading-tight focus:outline-none focus:shadow-outline text-sm bg-white rounded-2xl ml-2`\n                  })]\n                }), /*#__PURE__*/_jsxs(\"div\", {\n                  className: \"flex justify-items-stretch mt-4\",\n                  children: [/*#__PURE__*/_jsx(\"input\", {\n                    value: projectEmail,\n                    onChange: e => setProjectEmail(e.target.value),\n                    autoComplete: \"none\",\n                    className: \"border border-background focus:border-primary shadow appearance-none rounded w-full py-3 px-4 text-primarydark leading-tight focus:outline-none focus:shadow-outline text-sm bg-white rounded-2xl mr-2\",\n                    type: \"text\",\n                    placeholder: \"E-mail\"\n                  }), /*#__PURE__*/_jsx(\"input\", {\n                    value: projectNumber,\n                    onChange: e => setProjectNumber(e.target.value),\n                    autoComplete: \"none\",\n                    className: \"border border-background focus:border-primary shadow appearance-none rounded w-full py-3 px-4 text-primarydark leading-tight focus:outline-none focus:shadow-outline text-sm bg-white rounded-2xl ml-2\",\n                    type: \"text\",\n                    placeholder: \"Phone number\"\n                  })]\n                })]\n              }), /*#__PURE__*/_jsx(\"div\", {\n                className: \"flex justify-center items-center p-6 z-10\",\n                children: fileUrl || imageName !== 'blank' ? imageName == 'blank' ? /*#__PURE__*/_jsx(\"img\", {\n                  style: {\n                    height: '200px',\n                    width: '200px'\n                  },\n                  src: fileUrl,\n                  onClick: () => setImagesModal(true),\n                  className: \"cursor-pointer\"\n                }) : /*#__PURE__*/_jsx(\"img\", {\n                  onClick: () => setImagesModal(true),\n                  src: `/modal/${imageName}.svg`,\n                  height: 200,\n                  width: 200,\n                  className: \"cursor-pointer\",\n                  style: {\n                    height: '200px',\n                    width: '200px'\n                  }\n                }) : /*#__PURE__*/_jsx(\"img\", {\n                  onClick: () => browseImageOpen(),\n                  src: \"/edit-photo.svg\",\n                  height: 200,\n                  width: 200,\n                  className: \"cursor-pointer\",\n                  style: {\n                    height: '200px',\n                    width: '200px'\n                  }\n                })\n              }), /*#__PURE__*/_jsx(\"hr\", {\n                style: {\n                  width: '100%',\n                  color: '#6C63FF'\n                }\n              }), /*#__PURE__*/_jsxs(\"div\", {\n                className: \"flex items-center justify-between mt-8\",\n                children: [/*#__PURE__*/_jsx(\"p\", {\n                  onClick: () => router.push(`/dashboard/projects/${projectName}`),\n                  className: \"text-primarydark cursor-pointer\",\n                  children: \"Back\"\n                }), /*#__PURE__*/_jsx(\"button\", {\n                  type: \"submit\",\n                  className: \"z-50 border border-primary hover:bg-primary hover:text-white text-primary font-medium py-1.5 px-6 rounded-2xl focus:outline-none\",\n                  children: \"Edit\"\n                })]\n              })]\n            })\n          })]\n        })\n      })\n    })]\n  });\n};\n\nexport default _withSuperJSONPage(StartupEdit);","map":null,"metadata":{},"sourceType":"module"}