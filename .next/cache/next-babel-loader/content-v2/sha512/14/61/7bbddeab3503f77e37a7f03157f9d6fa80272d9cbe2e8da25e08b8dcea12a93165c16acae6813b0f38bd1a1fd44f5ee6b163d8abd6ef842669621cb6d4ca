{"ast":null,"code":"import React, { useState, useEffect, useCallback, useRef } from 'react';\nexport var useStateWithPromise = function useStateWithPromise(initialState) {\n  var _useState = useState(initialState),\n      state = _useState[0],\n      setState = _useState[1];\n\n  var resolverRef = useRef(null);\n  useEffect(function () {\n    if (resolverRef.current) {\n      resolverRef.current(state);\n      resolverRef.current = null;\n    }\n    /**\r\n     * Since a state update could be triggered with the exact same state again,\r\n     * it's not enough to specify state as the only dependency of this useEffect.\r\n     * That's why resolverRef.current is also a dependency, because it will guarantee,\r\n     * that handleSetState was called in previous render\r\n     */\n\n  }, [resolverRef.current, state]);\n  var handleSetState = useCallback(function (stateAction) {\n    setState(stateAction);\n    return new Promise(function (resolve) {\n      resolverRef.current = resolve;\n    });\n  }, [setState]);\n  return [state, handleSetState];\n};","map":null,"metadata":{},"sourceType":"module"}