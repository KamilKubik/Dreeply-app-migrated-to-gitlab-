{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport React, { useEffect, useMemo, useRef, useState } from 'react';\nimport gsap, { Power4 } from 'gsap';\nimport NavbarTemplate from '../../../NavbarTemplate';\nimport SectionManager from './SectionManager';\nimport fetcher from '../../../../../utils/fetcher';\nimport { useRouter } from 'next/router';\nimport useSWR from 'swr';\nimport { useAuth } from '../../../../../lib/newAuth';\nimport firebase, { db } from '../../../../../lib/firebase';\nimport InputElement from './InputElement';\nimport DisplayedData from './DisplayedData';\nimport { v4 as uuidv4 } from 'uuid';\n\nconst BusinessPlanContainer = () => {\n  const {\n    0: activeSection,\n    1: setActiveSection\n  } = useState('Startup overview');\n  const {\n    0: businessPlan,\n    1: setBusinessPlan\n  } = useState();\n  const {\n    0: projectId,\n    1: setProjectId\n  } = useState();\n  const containerRef = useRef();\n  const {\n    0: particularSection,\n    1: setParticularSection\n  } = useState(); // PROJECT\n\n  const {\n    0: ProjectPathName,\n    1: setProjectPathName\n  } = useState();\n  const {\n    currentUser\n  } = useAuth();\n  const router = useRouter();\n  const {\n    0: sections,\n    1: setSections\n  } = useState();\n  const {\n    0: sections1,\n    1: setSections1\n  } = useState();\n  const ref = db.collection('currentBusinessPlan');\n  useEffect(() => {\n    // PROJECT ID\n    // const gcp = async () => {\n    //   // const gcpdata = await db.collection('currentProject').doc('uid', '==', currentUser.uid).get();\n    //   await db\n    //     .collection('projects')\n    //     .where('uid', '==', currentUser.uid)\n    //     .where('projectName', '==', router.query.project)\n    //     .get()\n    //     .then((querySnapshot) => {\n    //       querySnapshot.forEach((doc) => {\n    //         return setProjectId(doc.data().projectId);\n    //       });\n    //     });\n    // };\n    // gcp()\n    ref.doc(currentUser.uid).collection('data').where('name', '==', activeSection).onSnapshot(querySnapshot => {\n      const items = [];\n      querySnapshot.forEach(doc => {\n        console.log(doc.data());\n        items.push(...doc.data().values); // setSections1(doc.data());\n      });\n      setSections1(items);\n    }); // GSAP\n\n    gsap.fromTo(containerRef.current, {\n      autoAlpha: 0\n    }, {\n      autoAlpha: 1,\n      duration: 2,\n      ease: Power4.easeOut\n    });\n  }, [activeSection]); // useEffect(() => {\n  //   // PARTICULAR SECTION\n  //   const item = sections && sections.find((doc) => doc.name == activeSection);\n  //   setParticularSection(item);\n  // }, [activeSection]);\n\n  console.log('CONTAINER SECTIONS - ', sections);\n\n  const doingMyBest = () => {\n    const {\n      data\n    } = useSWR(currentUser && projectId ? [`/api/business-plan/${projectId}`, currentUser.token] : null, fetcher); // return setBusinessPlan(data);\n    // console.log(data);\n\n    useMemo(() => data && data.map(project => {\n      // useMemo jest po to, żeby nie było rerenderów (w sensie wyskakuje wtedy błąd, że za dużo renderowań)\n      setBusinessPlan(project);\n      setProjectPathName(project.pathName);\n    }), [data]);\n  };\n\n  doingMyBest(); // console.log('PROJECT ID --> ', projectId);\n\n  console.log('OFFICIAL DATA --> ', businessPlan); // console.log('PROJECT PATHNAME FROM SWR --> ', ProjectPathName);\n\n  console.log('ACTIVE SECTION', activeSection);\n  console.log('PARTICULAR SECTION --> ', particularSection);\n  const {\n    0: dataFromInput,\n    1: setDataFromInput\n  } = useState();\n  const {\n    0: changedData,\n    1: setChangedData\n  } = useState();\n  console.log('DATA FROM INPUT --> ', dataFromInput); // ON ADD NEW INPUT\n\n  const addNewInput = async () => {\n    // Add new section to data collection\n    const dataToUpload = dataFromInput ? dataFromInput : {\n      inputs: []\n    }; //   setSections1(null);\n    //   await sections1.sections.push({ blocks: [] });\n    //   await db\n    //     .collection('currentBusinessPlan')\n    //     .doc(currentUser.uid)\n    //     .collection('data')\n    //     .doc(activeSection)\n    //     .update({\n    //       sections1\n    //     })\n    // };\n\n    setSections1(null);\n    await db.collection('currentBusinessPlan').doc(currentUser.uid).collection('data').doc(activeSection).update({\n      values: firebase.firestore.FieldValue.arrayUnion({\n        blocks: [],\n        id: uuidv4(),\n        type: 'textarea'\n      })\n    });\n  };\n\n  console.log('SECTIONS1', sections1);\n  return /*#__PURE__*/_jsx(_Fragment, {\n    children: /*#__PURE__*/_jsx(NavbarTemplate, {\n      children: /*#__PURE__*/_jsx(\"div\", {\n        ref: containerRef,\n        className: \"min-h-screen w-full relative flex flex-col items-center\",\n        children: /*#__PURE__*/_jsxs(\"div\", {\n          className: \"w-full max-w-full relative mt-16 px-32\",\n          children: [/*#__PURE__*/_jsxs(\"div\", {\n            className: \"grid grid-cols-2 grid-rows-1 grid-flow-col\",\n            children: [/*#__PURE__*/_jsxs(\"div\", {\n              className: \"flex items-center\",\n              children: [/*#__PURE__*/_jsxs(\"svg\", {\n                height: \"30\",\n                width: \"30\",\n                className: \"fill-current text-primary dark:text-primarydark\",\n                xmlns: \"http://www.w3.org/2000/svg\",\n                viewBox: \"0 0 128 128\",\n                children: [/*#__PURE__*/_jsx(\"title\", {\n                  children: \"Landing Success\"\n                }), /*#__PURE__*/_jsx(\"g\", {\n                  id: \"Landing_Success\",\n                  \"data-name\": \"Landing Success\",\n                  children: /*#__PURE__*/_jsx(\"path\", {\n                    className: \"cls-1\",\n                    d: \"M109.3,90.1A46,46,0,0,0,65,36V20.08c1.78-.62,7.21-2.14,12.57.23a19.33,19.33,0,0,0,14.82,0c.87-.38.61.31.61-17.93a1,1,0,0,0-1.43-.93c-.07,0-6.69,2.87-13.18,0A19.41,19.41,0,0,0,65,.93,1,1,0,0,0,63,1V36a45.86,45.86,0,0,0-28.66,10.8C16.18,40.48,4,40,.79,45.51-2.29,50.86,3.94,59.3,10,65.68A11,11,0,0,0,18,83c.81,38.41,46.08,59.2,75.66,34.21,8.53,3,29,9.15,33.55,1.31C130.39,113,123.86,102.65,109.3,90.1ZM77.59,3.31A19.39,19.39,0,0,0,91,3.83V18.68c-1.79.62-7.22,2.13-12.57-.23A19.19,19.19,0,0,0,65,17.93V3.08C66.81,2.46,72.24,1,77.59,3.31ZM65,45v-7c39.69.91,58,50.27,28.21,76.81C71.32,107,46,92.66,27.77,78.64a11,11,0,0,0-3.2-16.13A43.88,43.88,0,0,1,63,38.06V45A1,1,0,0,0,65,45ZM32.55,48.36a46.21,46.21,0,0,0-9.83,13.28,10.93,10.93,0,0,0-11.4,2.47C-8.39,43.23,5.23,39.08,32.55,48.36ZM10,72a9,9,0,1,1,9,9A9,9,0,0,1,10,72Zm10,11a11,11,0,0,0,6.34-2.82c18.45,14.21,43.45,28.35,65.05,36.22C63,139.16,20.83,119.1,20.05,83Zm105.4,34.5c-2.51,4.35-14,3.62-30-1.85a45.61,45.61,0,0,0,13.42-23.21C121.59,103.58,128,113.12,125.45,117.47Z\"\n                  })\n                })]\n              }), /*#__PURE__*/_jsx(\"p\", {\n                className: \"text-primarydark text-2xl mt-2 pl-2 dark:text-background\",\n                children: \"Business plan\"\n              })]\n            }), /*#__PURE__*/_jsx(\"div\", {\n              className: \"flex justify-end mt-4\",\n              children: /*#__PURE__*/_jsx(\"button\", {\n                className: \"hover:bg-primary hover:text-white dark:hover:bg-primarydark dark:hover:text-background focus:outline-none border border-primary text-primary text-sm font-light py-2 px-8 rounded-2xl mt-2 dark:text-primarydark dark:border-primarydark\",\n                children: \"Settings\"\n              })\n            })]\n          }), /*#__PURE__*/_jsx(\"div\", {\n            children: /*#__PURE__*/_jsx(\"h1\", {\n              className: \"text-secondary text-md text-gray\",\n              children: \"Create your business plan any way you want\"\n            })\n          }), /*#__PURE__*/_jsxs(\"div\", {\n            className: \"grid grid-cols-8fr grid-flow-col\",\n            children: [/*#__PURE__*/_jsxs(\"div\", {\n              className: \"col-start-1 col-end-7 w-full mt-12\",\n              children: [/*#__PURE__*/_jsx(\"h1\", {\n                className: \"text-primarydark text-base dark:text-background\",\n                children: \"Manage your input\"\n              }), /*#__PURE__*/_jsxs(\"div\", {\n                className: \"relative flex flex-col h-full w-full flex px-8 pt-8 pb-4 rounded-2xl bg-white dark:bg-background mt-1\",\n                children: [sections1 && sections1.map(section => {\n                  return /*#__PURE__*/_jsxs(\"div\", {\n                    children: [/*#__PURE__*/_jsx(\"p\", {\n                      children: \"Sections below:\"\n                    }), /*#__PURE__*/_jsx(InputElement, {\n                      setDataFromInput: setDataFromInput,\n                      data: section\n                    })]\n                  });\n                }), /*#__PURE__*/_jsx(\"div\", {\n                  children: /*#__PURE__*/_jsx(\"button\", {\n                    onClick: addNewInput,\n                    children: \"Add Item\"\n                  })\n                })]\n              })]\n            }), /*#__PURE__*/_jsx(SectionManager, {\n              setSections1: setSections1,\n              setDataFromInput: setDataFromInput,\n              dataFromInput: dataFromInput,\n              activeSection: activeSection,\n              setActiveSection: setActiveSection\n            })]\n          })]\n        })\n      })\n    })\n  });\n};\n\nexport default BusinessPlanContainer;","map":null,"metadata":{},"sourceType":"module"}