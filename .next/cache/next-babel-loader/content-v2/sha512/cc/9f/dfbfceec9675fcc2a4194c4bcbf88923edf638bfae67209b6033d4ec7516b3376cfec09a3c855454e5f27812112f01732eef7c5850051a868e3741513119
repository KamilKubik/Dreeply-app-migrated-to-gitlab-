{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport _regeneratorRuntime from \"C:/off-saas/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"C:/off-saas/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { withSuperJSONPage as _withSuperJSONPage } from \"babel-plugin-superjson-next/tools\";\nimport React, { useEffect, useState, useRef } from 'react';\nimport { useRouter } from 'next/router';\nimport gsap, { Linear } from 'gsap';\nimport { v4 as uuidv4 } from 'uuid';\nimport { useAuth } from '../../../../lib/newAuth';\nimport { db } from '../../../../lib/firebase';\nimport NavbarTemplate from '../../../../components/dashboard/NavbarTemplate';\nimport { CountryDropdown } from 'react-country-region-selector';\nimport ImagesModal from '../../../../components/dashboard/startup/ImagesModal';\nimport Image from 'next/image';\nimport TippyMonster from '../../../../components/dashboard/Tippy';\nimport BounceLoaderComponent from '../../../../components/BounceLoader';\n\nvar StartupEdit = function StartupEdit() {\n  var _useState = useState(null),\n      projects = _useState[0],\n      setProjects = _useState[1];\n\n  var _useState2 = useState(null),\n      currentProject = _useState2[0],\n      setCurrentProject = _useState2[1];\n\n  var _useState3 = useState(''),\n      existingProjectName = _useState3[0],\n      setExistingProjectName = _useState3[1];\n\n  var _useState4 = useState(''),\n      projectName = _useState4[0],\n      setProjectName = _useState4[1];\n\n  var _useState5 = useState(''),\n      projectDescription = _useState5[0],\n      setProjectDescription = _useState5[1];\n\n  var _useState6 = useState(''),\n      projectField = _useState6[0],\n      setProjectField = _useState6[1];\n\n  var _useState7 = useState(''),\n      projectCountry = _useState7[0],\n      setProjectCountry = _useState7[1];\n\n  var _useState8 = useState(''),\n      projectEmail = _useState8[0],\n      setProjectEmail = _useState8[1];\n\n  var _useState9 = useState(''),\n      projectNumber = _useState9[0],\n      setProjectNumber = _useState9[1];\n\n  var _useState10 = useState(''),\n      projectImage = _useState10[0],\n      setProjectImage = _useState10[1];\n\n  var _useState11 = useState('blank'),\n      imageName = _useState11[0],\n      setImageName = _useState11[1];\n\n  var _useState12 = useState(''),\n      projectId = _useState12[0],\n      setProjectId = _useState12[1];\n\n  var _useState13 = useState(false),\n      imagesModal = _useState13[0],\n      setImagesModal = _useState13[1];\n\n  var _useState14 = useState(null),\n      fileUrl = _useState14[0],\n      setFileUrl = _useState14[1]; // LOADING SCREEN\n\n\n  var _useState15 = useState(false),\n      loadingScreen = _useState15[0],\n      setLoadingScreen = _useState15[1]; // GSAP\n\n\n  var mainContainer = useRef();\n  var router = useRouter();\n\n  var _useAuth = useAuth(),\n      currentUser = _useAuth.currentUser;\n\n  useEffect( /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n    var currentProject, projects;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            // FETCH CURRENT PROJECT\n            currentProject = [];\n            _context.next = 3;\n            return db.collection('projects').where('uid', '==', currentUser.uid).where('projectName', '==', router.query.project).get().then(function (querySnapshot) {\n              if (querySnapshot.empty) {\n                return router.push('/dashboard/startup');\n              }\n\n              querySnapshot.forEach(function (doc) {\n                setProjectName(doc.data().projectName);\n                setProjectDescription(doc.data().projectDescription);\n                setProjectField(doc.data().projectField);\n                setProjectCountry(doc.data().projectCountry);\n                setProjectEmail(doc.data().projectEmail);\n                setProjectNumber(doc.data().projectNumber);\n                setImageName(doc.data().imageName);\n                setFileUrl(doc.data().imageFileUrl);\n                setProjectId(doc.data().projectId);\n                setExistingProjectName(doc.data().projectName);\n                currentProject.push(doc.data());\n              });\n            });\n\n          case 3:\n            setCurrentProject(currentProject); // FETCH ALL USER PROJECTS\n\n            projects = [];\n            _context.next = 7;\n            return db.collection('projects').where('uid', '==', currentUser.uid).get().then(function (querySnapshot) {\n              if (querySnapshot.empty) {\n                return router.push('/dashboard/startup');\n              }\n\n              querySnapshot.forEach(function (doc) {\n                projects.push(doc.data());\n              });\n            });\n\n          case 7:\n            setProjects(projects);\n\n          case 8:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  })), []);\n  console.log(currentProject);\n  console.log(projects);\n  console.log(projectName);\n  console.log(router.query.project);\n\n  var onProjectEdit = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(e) {\n      var newProject;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              e.preventDefault();\n              projects && projects.map(function (project) {\n                if (project.projectName == projectName && projectName !== router.query.project) {\n                  setWrongNameTippyHelper(true);\n                  return;\n                }\n              });\n\n              if (!(!projectName || !projectDescription || !projectField || !projectCountry || !projectEmail || !projectNumber || !imageName && !fileUrl)) {\n                _context2.next = 5;\n                break;\n              }\n\n              setTippyHelper(true);\n              return _context2.abrupt(\"return\");\n\n            case 5:\n              _context2.next = 7;\n              return gsap.to(mainContainer.current, {\n                autoAlpha: 0,\n                duration: 1,\n                ease: Linear\n              });\n\n            case 7:\n              // SHOW LOADING SCREEN\n              setLoadingScreen(true); // UPDATED PROJECT\n\n              newProject = {\n                projectName: projectName,\n                projectDescription: projectDescription,\n                projectField: projectField,\n                projectCountry: projectCountry,\n                projectEmail: projectEmail,\n                projectNumber: projectNumber,\n                imageName: imageName,\n                imageFileUrl: fileUrl\n              };\n              _context2.next = 11;\n              return db.collection('projects').doc(projectId).update(newProject);\n\n            case 11:\n              router.push(\"/dashboard/projects/\".concat(projectName));\n\n            case 12:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function onProjectEdit(_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var onFileChange = /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(e) {\n      var file, storageRef, fileRef;\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              if (imageName && fileUrl) {\n                setImageName('blank');\n              }\n\n              setImagesModal(false);\n              file = e.target.files[0];\n              storageRef = storage.ref();\n              fileRef = storageRef.child(file.name);\n              _context3.next = 7;\n              return fileRef.put(file);\n\n            case 7:\n              _context3.t0 = setFileUrl;\n              _context3.next = 10;\n              return fileRef.getDownloadURL();\n\n            case 10:\n              _context3.t1 = _context3.sent;\n              (0, _context3.t0)(_context3.t1);\n\n            case 12:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n\n    return function onFileChange(_x2) {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  var browseImageOpen = function browseImageOpen() {\n    setImagesModal(true);\n    setImageName('blank');\n  };\n\n  var _useState16 = useState(false),\n      tippyHelper = _useState16[0],\n      setTippyHelper = _useState16[1];\n\n  var _useState17 = useState(false),\n      wrongNameTippyHelper = _useState17[0],\n      setWrongNameTippyHelper = _useState17[1];\n\n  return /*#__PURE__*/_jsxs(_Fragment, {\n    children: [/*#__PURE__*/_jsx(TippyMonster, {\n      tippyMonster: tippyHelper ? true : false,\n      wrongName: wrongNameTippyHelper ? true : false,\n      setTippyHelper: setTippyHelper,\n      setWrongNameTippyHelper: setWrongNameTippyHelper,\n      projectCreator: true,\n      contentClass: \"h-20 w-80 shadow-lg rounded-2xl bg-primary flex justify-center items-center\",\n      contentText: \"Let's modify the fundamental information about your startup.\"\n    }), imagesModal && /*#__PURE__*/_jsx(ImagesModal, {\n      currentUser: currentUser,\n      onFileChange: onFileChange,\n      setImagesModal: setImagesModal,\n      setImageName: setImageName\n    }), loadingScreen ? /*#__PURE__*/_jsx(BounceLoaderComponent, {}) : /*#__PURE__*/_jsx(NavbarTemplate, {\n      children: /*#__PURE__*/_jsx(\"div\", {\n        ref: mainContainer,\n        className: \"min-h-screen w-full max-w-full relative px-32 py-16 flex items-center flex-col\",\n        children: /*#__PURE__*/_jsxs(\"div\", {\n          className: \"z-10 p-10 h-auto grid grid-cols-1 grid-rows-3 w-auto max-w-nameContainer w-full bg-white rounded-3xl\",\n          children: [/*#__PURE__*/_jsxs(\"div\", {\n            className: \"row-span-1 text-center\",\n            children: [/*#__PURE__*/_jsxs(\"div\", {\n              className: \"text-2xl font-medium flex items-center justify-center\",\n              children: [/*#__PURE__*/_jsx(\"img\", {\n                src: \"/project-create/rocket.svg\",\n                height: 36,\n                width: 36,\n                className: \"inline-block relative bottom-1\"\n              }), /*#__PURE__*/_jsx(\"p\", {\n                className: \"ml-2 text-primarydark\",\n                children: \"Let's create your startup!\"\n              })]\n            }), /*#__PURE__*/_jsx(\"div\", {\n              className: \"text-base text-gray px-4\",\n              children: \"Oops, one more tiny step and we will get down to business.\"\n            })]\n          }), /*#__PURE__*/_jsx(\"div\", {\n            className: \"row-span-2\",\n            children: /*#__PURE__*/_jsxs(\"form\", {\n              onSubmit: function onSubmit(e) {\n                return onProjectEdit(e);\n              },\n              className: \"z-50 px-4 pt-2 rounded-2xl mt-4\",\n              children: [/*#__PURE__*/_jsx(\"div\", {\n                className: \"mb-4\",\n                children: /*#__PURE__*/_jsx(\"input\", {\n                  value: projectName,\n                  onChange: function onChange(e) {\n                    return setProjectName(e.target.value);\n                  },\n                  id: \"startup-name\",\n                  className: \"border border-background focus:border-primary shadow appearance-none rounded w-full py-3 px-4 text-primarydark leading-tight focus:outline-none focus:shadow-outline text-sm bg-white rounded-2xl mr-2\",\n                  type: \"startup-name\",\n                  placeholder: \"startup name\"\n                })\n              }), /*#__PURE__*/_jsx(\"div\", {\n                className: \"mb-4\",\n                children: /*#__PURE__*/_jsx(\"textarea\", {\n                  value: projectDescription,\n                  onChange: function onChange(e) {\n                    return setProjectDescription(e.target.value);\n                  },\n                  id: \"startup-description\",\n                  style: {\n                    maxHeight: 160\n                  },\n                  className: \"border border-background focus:border-primary shadow appearance-none rounded w-full py-3 px-4 text-primarydark leading-tight focus:outline-none focus:shadow-outline text-sm bg-white rounded-2xl mr-2 pb-12\",\n                  type: \"startup-description\",\n                  placeholder: \"startup description\"\n                })\n              }), /*#__PURE__*/_jsxs(\"div\", {\n                className: \"mb-4\",\n                children: [/*#__PURE__*/_jsxs(\"div\", {\n                  className: \"flex justify-items-stretch\",\n                  children: [/*#__PURE__*/_jsx(\"input\", {\n                    value: projectField,\n                    onChange: function onChange(e) {\n                      return setProjectField(e.target.value);\n                    },\n                    autoComplete: \"none\",\n                    className: \"border border-background focus:border-primary shadow appearance-none rounded w-full py-3 px-4 text-primarydark leading-tight focus:outline-none focus:shadow-outline text-sm bg-white rounded-2xl mr-2\",\n                    type: \"text\",\n                    placeholder: \"Startup field\"\n                  }), /*#__PURE__*/_jsx(CountryDropdown, {\n                    value: projectCountry,\n                    onChange: function onChange(country) {\n                      return setProjectCountry(country);\n                    },\n                    id: \"test\",\n                    defaultOptionLabel: \"Country\",\n                    className: \"\".concat(projectCountry ? 'text-primarydark' : 'text-placeholder', \" border border-background focus:border-primary shadow appearance-none rounded w-full py-3 px-4 leading-tight focus:outline-none focus:shadow-outline text-sm bg-white rounded-2xl ml-2\")\n                  })]\n                }), /*#__PURE__*/_jsxs(\"div\", {\n                  className: \"flex justify-items-stretch mt-4\",\n                  children: [/*#__PURE__*/_jsx(\"input\", {\n                    value: projectEmail,\n                    onChange: function onChange(e) {\n                      return setProjectEmail(e.target.value);\n                    },\n                    autoComplete: \"none\",\n                    className: \"border border-background focus:border-primary shadow appearance-none rounded w-full py-3 px-4 text-primarydark leading-tight focus:outline-none focus:shadow-outline text-sm bg-white rounded-2xl mr-2\",\n                    type: \"text\",\n                    placeholder: \"E-mail\"\n                  }), /*#__PURE__*/_jsx(\"input\", {\n                    value: projectNumber,\n                    onChange: function onChange(e) {\n                      return setProjectNumber(e.target.value);\n                    },\n                    autoComplete: \"none\",\n                    className: \"border border-background focus:border-primary shadow appearance-none rounded w-full py-3 px-4 text-primarydark leading-tight focus:outline-none focus:shadow-outline text-sm bg-white rounded-2xl ml-2\",\n                    type: \"text\",\n                    placeholder: \"Phone number\"\n                  })]\n                })]\n              }), /*#__PURE__*/_jsx(\"div\", {\n                className: \"flex justify-center items-center p-6 z-10\",\n                children: fileUrl || imageName !== 'blank' ? imageName == 'blank' ? /*#__PURE__*/_jsx(\"img\", {\n                  style: {\n                    height: '200px',\n                    width: '200px'\n                  },\n                  src: fileUrl,\n                  onClick: function onClick() {\n                    return setImagesModal(true);\n                  },\n                  className: \"cursor-pointer\"\n                }) : /*#__PURE__*/_jsx(\"img\", {\n                  onClick: function onClick() {\n                    return setImagesModal(true);\n                  },\n                  src: \"/modal/\".concat(imageName, \".svg\"),\n                  height: 200,\n                  width: 200,\n                  className: \"cursor-pointer\",\n                  style: {\n                    height: '200px',\n                    width: '200px'\n                  }\n                }) : /*#__PURE__*/_jsx(\"img\", {\n                  onClick: function onClick() {\n                    return browseImageOpen();\n                  },\n                  src: \"/edit-photo.svg\",\n                  height: 200,\n                  width: 200,\n                  className: \"cursor-pointer\",\n                  style: {\n                    height: '200px',\n                    width: '200px'\n                  }\n                })\n              }), /*#__PURE__*/_jsx(\"hr\", {\n                style: {\n                  width: '100%',\n                  color: '#6C63FF'\n                }\n              }), /*#__PURE__*/_jsxs(\"div\", {\n                className: \"flex items-center justify-between mt-8\",\n                children: [/*#__PURE__*/_jsx(\"p\", {\n                  onClick: function onClick() {\n                    return router.push(\"/dashboard/projects/\".concat(projectName));\n                  },\n                  className: \"text-primarydark cursor-pointer\",\n                  children: \"Back\"\n                }), /*#__PURE__*/_jsx(\"button\", {\n                  type: \"submit\",\n                  className: \"z-50 border border-primary hover:bg-primary hover:text-white text-primary font-medium py-1.5 px-6 rounded-2xl focus:outline-none\",\n                  children: \"Edit\"\n                })]\n              })]\n            })\n          })]\n        })\n      })\n    })]\n  });\n};\n\nexport default _withSuperJSONPage(StartupEdit);","map":null,"metadata":{},"sourceType":"module"}